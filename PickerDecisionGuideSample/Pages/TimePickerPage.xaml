<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="PickerDecisionGuideSample.Pages.TimePickerPage"
             xmlns:timePicker="clr-namespace:Syncfusion.Maui.Picker;assembly=Syncfusion.Maui.Picker"
             xmlns:listView="clr-namespace:Syncfusion.Maui.ListView;assembly=Syncfusion.Maui.ListView"
             xmlns:popup="clr-namespace:Syncfusion.Maui.Popup;assembly=Syncfusion.Maui.Popup"
             xmlns:buttons="clr-namespace:Syncfusion.Maui.Buttons;assembly=Syncfusion.Maui.Buttons"
             x:DataType="vm:TimePickerCustomizationViewModel"
             Background="{AppThemeBinding Light={StaticResource BackgroundLight}, Dark={StaticResource BackgroundDark}}" Padding="{OnPlatform WinUI=-10, MacCatalyst=-10, Default=0}"
             xmlns:vm="clr-namespace:PickerDecisionGuideSample.ViewModels">


    <ContentPage.Resources>
        <vm:TimeSpanConverter x:Key="TimeSpanConverter"/>
        <vm:AlarmTimer x:Key="AlarmTimer"/>

        <Style x:Key="AlarmSwitchStyle" TargetType="buttons:SfSwitch">
            <Setter Property="VisualStateManager.VisualStateGroups">
                <Setter.Value>
                    <VisualStateGroupList>
                        <VisualStateGroup x:Name="CommonStates">
                            <VisualState x:Name="On">
                                <VisualState.Setters>
                                    <Setter Property="SwitchSettings">
                                        <Setter.Value>
                                            <buttons:SwitchSettings
                                                ThumbWidthRequest="26"
                                                ThumbHeightRequest="26"
                                                IconColor="{AppThemeBinding Light={StaticResource PrimaryBackground}, Dark={StaticResource PrimaryBackground}}"
                                                CustomPath="M14.2051 0.744141L15.207 1.74609L5.69727 11.2559L0.792969 6.35156L1.79492 5.34961L5.69727 9.25195L14.2051 0.744141Z" />
                                        </Setter.Value>
                                    </Setter>
                                </VisualState.Setters>
                            </VisualState>
                            <VisualState x:Name="Off">
                                <VisualState.Setters>
                                    <Setter Property="SwitchSettings">
                                        <Setter.Value>
                                            <buttons:SwitchSettings />
                                        </Setter.Value>
                                    </Setter>
                                </VisualState.Setters>
                            </VisualState>
                        </VisualStateGroup>
                    </VisualStateGroupList>
                </Setter.Value>
            </Setter>
        </Style>
    </ContentPage.Resources>
    <ContentPage.BindingContext>
        <vm:TimePickerCustomizationViewModel/>
    </ContentPage.BindingContext>
    <ContentPage.Content>
        <Grid>
            <Border IsVisible="{OnPlatform Default=True, Android=False, iOS=False}" Margin="0" Padding="0" BackgroundColor="Transparent" Stroke="{AppThemeBinding Light={StaticResource BorderLight}, Dark={StaticResource Border}}" HeightRequest="550" WidthRequest="375" VerticalOptions="Center" HorizontalOptions="Center">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="16" />
                </Border.StrokeShape>
                <Grid Grid.Column="{OnPlatform Default=0, WinUI=1, MacCatalyst=1}" WidthRequest="{OnPlatform WinUI=350, MacCatalyst=350, Default=350}" HorizontalOptions="{OnPlatform Android=Center, iOS=Center, MacCatalyst=End, WinUI=End}"  Grid.ColumnSpan="{OnPlatform Default=2, WinUI=1, MacCatalyst=1}" BackgroundColor="Transparent" Margin="{OnPlatform WinUI=10, MacCatalyst=10, Default=0}">

                    <CollectionView ZIndex="{OnPlatform MacCatalyst=1}" x:Name="alarmListView" WidthRequest="{OnPlatform WinUI=330, MacCatalyst=330, Default=350}" ItemsSource="{Binding AlarmCollection}" VerticalScrollBarVisibility="Never" HorizontalOptions="Center" Margin="10">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="vm:AlarmDetails">
                                <Grid>
                                    <Border x:Name="alarmBorder" StrokeShape="RoundRectangle 5" Stroke="{AppThemeBinding Light={StaticResource BorderLight}, Dark={StaticResource Border}}" BackgroundColor="{AppThemeBinding Light={StaticResource SampleBrowserBackgroundLight}, Dark={StaticResource SampleBrowserBackground}}" Margin="0,0,0,5" HeightRequest="130" WidthRequest="{OnPlatform WinUI=330}">
                                        <Grid Padding="10">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="2*"/>
                                                <RowDefinition Height="*"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="60" />
                                            </Grid.ColumnDefinitions>
                                            <HorizontalStackLayout VerticalOptions="Center" Margin="0" Padding="0">
                                                <Label>
                                                    <Label.FormattedText>
                                                        <FormattedString>
                                                            <Span Text="{Binding AlarmTime, Converter={StaticResource TimeSpanConverter}, ConverterParameter={x:Boolean True}}" FontSize="36" FontAttributes="Bold" TextColor="{Binding AlarmTextColor}"/>
                                                            <Span Text="{Binding AlarmTime, Converter={StaticResource TimeSpanConverter}, ConverterParameter={x:Boolean False}}" FontSize="16" FontAttributes="Bold" TextColor="{Binding AlarmTextColor}"/>
                                                        </FormattedString>
                                                    </Label.FormattedText>
                                                </Label>
                                            </HorizontalStackLayout>
                                            <buttons:SfSwitch x:Name="alarmSwitch" Grid.Column="1" IsOn="{Binding IsAlarmEnabled}" HorizontalOptions="End" VerticalOptions="Start" StateChanged="alarmSwitch_Toggled" Margin="0" Style="{StaticResource AlarmSwitchStyle}"/>
                                            <HorizontalStackLayout Grid.Row="1" Grid.ColumnSpan="2" Margin="0, 10, 0, 0" Spacing="5" >
                                                <Path Fill="{Binding AlarmSecondaryTextColor}" Data="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17.93c-2.83.48-5.5-1.51-5.98-4.34 -.48-2.83 1.51-5.5 4.34-5.98 2.83-.48 5.5 1.51 5.98 4.34 .48 2.83-1.51 5.5-4.34 5.98z" WidthRequest="24" HeightRequest="24" HorizontalOptions="Start" VerticalOptions="Center"/>
                                                <Label Text="{Binding AlarmTime, Converter={StaticResource AlarmTimer}}" TextColor="{Binding AlarmSecondaryTextColor}" FontSize="13"/>
                                            </HorizontalStackLayout>
                                            <Label Text="{Binding AlarmMessage}" Grid.Row="2" Grid.ColumnSpan="2" Margin="0, 0, 10, 0" VerticalOptions="End" TextColor="{Binding AlarmTextColor}" FontSize="14"/>
                                        </Grid>
                                        <Border.GestureRecognizers>
                                            <TapGestureRecognizer Tapped="OnAlarmTapped"/>
                                        </Border.GestureRecognizers>
                                    </Border>
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                    <vm:AlarmPopup x:Name="alarmPopup" OnCreated="alarmPopup_OnCreated"/>
                    <timePicker:SfTimePicker x:Name="alarmEditPicker" Background="Transparent" InputTransparent="True" Mode="Dialog" Format="hh_mm_tt" OkButtonClicked="AlarmEditPicker_OkButtonClicked" CancelButtonClicked="alarmEditPicker_CancelButtonClicked"/>

                    <Grid ZIndex="{OnPlatform MacCatalyst=1}" Grid.Row="1" HeightRequest="50" VerticalOptions="End" HorizontalOptions="End" Margin ="10">
                        <Path Fill="{AppThemeBinding Default={StaticResource PrimaryBackground}}">
                            <Path.Data>
                                <EllipseGeometry Center="25,25" RadiusX="25" RadiusY="25" />
                            </Path.Data>
                        </Path>
                        <Grid VerticalOptions="Center">
                            <Label TextColor="{AppThemeBinding Default={StaticResource PrimaryForeground}}" FontSize="25" HorizontalTextAlignment="Center" VerticalTextAlignment="Center" Text="+"/>
                        </Grid>
                        <Grid.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnAddAlarmTapped"/>
                        </Grid.GestureRecognizers>
                    </Grid>
                </Grid>
            </Border>

            <Grid IsVisible="{OnPlatform Default=True, WinUI=False, MacCatalyst=False}" WidthRequest="{OnPlatform WinUI=350, MacCatalyst=350, Default=350}" HorizontalOptions="{OnPlatform Android=Center, iOS=Center, MacCatalyst=End, WinUI=End}" BackgroundColor="Transparent" Margin="{OnPlatform WinUI=10, MacCatalyst=10, Default=0}">

                <CollectionView ZIndex="{OnPlatform iOS=1}" x:Name="alarmListView1" WidthRequest="{OnPlatform WinUI=330, MacCatalyst=330, Default=350}" ItemsSource="{Binding AlarmCollection}" VerticalScrollBarVisibility="Never" HorizontalOptions="Center" Margin="10">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="vm:AlarmDetails">
                            <Grid>
                                <Border x:Name="alarmBorder1" StrokeShape="RoundRectangle 5" Stroke="{AppThemeBinding Light={StaticResource BorderLight}, Dark={StaticResource Border}}" BackgroundColor="{AppThemeBinding Light={StaticResource SampleBrowserBackgroundLight}, Dark={StaticResource SampleBrowserBackground}}" Margin="0,0,0,5" HeightRequest="130" WidthRequest="{OnPlatform WinUI=330}">
                                    <Grid Padding="5">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="2*"/>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="60" />
                                        </Grid.ColumnDefinitions>
                                        <HorizontalStackLayout VerticalOptions="End" Margin="0" Padding="0">
                                            <Label>
                                                <Label.FormattedText>
                                                    <FormattedString>
                                                        <Span Text="{Binding AlarmTime, Converter={StaticResource TimeSpanConverter}, ConverterParameter={x:Boolean True}}" FontSize="50" FontAttributes="Bold" TextColor="{Binding AlarmTextColor}"/>
                                                        <Span Text="{Binding AlarmTime, Converter={StaticResource TimeSpanConverter}, ConverterParameter={x:Boolean False}}" FontSize="15" FontAttributes="Bold" TextColor="{Binding AlarmTextColor}"/>
                                                    </FormattedString>
                                                </Label.FormattedText>
                                            </Label>
                                        </HorizontalStackLayout>
                                        <buttons:SfSwitch x:Name="alarmSwitch1" Grid.Column="1" IsOn="{Binding IsAlarmEnabled}" HorizontalOptions="End" VerticalOptions="Start" StateChanged="alarmSwitch_Toggled" Margin="0" Style="{StaticResource AlarmSwitchStyle}"/>
                                        <HorizontalStackLayout Grid.Row="1" Grid.ColumnSpan="2" Margin="0, 10, 0, 0" Spacing="5" >
                                            <Label FontFamily="{OnPlatform iOS=Sync FontIcons, MacCatalyst=Sync FontIcons, Android=Sync FontIcons.ttf#, WinUI=Sync FontIcons.ttf#Sync FontIcons}" TextColor="{Binding AlarmSecondaryTextColor}" FontSize="15" HorizontalOptions="Start" Text="&#xe759;" VerticalOptions="Center"/>
                                            <Label Text="{Binding AlarmTime, Converter={StaticResource AlarmTimer}}" TextColor="{Binding AlarmSecondaryTextColor}" />
                                        </HorizontalStackLayout>
                                        <Label Text="{Binding AlarmMessage}" Grid.Row="2" Grid.ColumnSpan="2" Margin="0, 0, 10, 0" VerticalOptions="End" TextColor="{Binding AlarmTextColor}"/>
                                    </Grid>
                                    <Border.GestureRecognizers>
                                        <TapGestureRecognizer Tapped="OnAlarmTapped"/>
                                    </Border.GestureRecognizers>
                                </Border>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
                <vm:AlarmPopup x:Name="alarmPopup1" OnCreated="alarmPopup_OnCreated"/>
                <timePicker:SfTimePicker x:Name="alarmEditPicker1" Background="Transparent" InputTransparent="True" Mode="Dialog" Format="hh_mm_tt" OkButtonClicked="AlarmEditPicker_OkButtonClicked" CancelButtonClicked="alarmEditPicker_CancelButtonClicked"/>

                <Grid ZIndex="{OnPlatform iOS=1}" Grid.Row="1" HeightRequest="50" VerticalOptions="End" HorizontalOptions="End" Margin ="10">
                    <Path Fill="{AppThemeBinding Default={StaticResource PrimaryBackground}}">
                        <Path.Data>
                            <EllipseGeometry Center="25,25" RadiusX="25" RadiusY="25" />
                        </Path.Data>
                    </Path>
                    <Grid VerticalOptions="Center">
                        <Label TextColor="{AppThemeBinding Default={StaticResource PrimaryForeground}}" FontSize="25" HorizontalTextAlignment="Center" VerticalTextAlignment="Center" Text="+"/>
                    </Grid>
                    <Grid.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnAddAlarmTapped"/>
                    </Grid.GestureRecognizers>
                </Grid>
            </Grid>

        </Grid>
    </ContentPage.Content>
</ContentPage>